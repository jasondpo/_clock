<title>Local storage test</title>
<!DOCTYPE html>

<!--
	STEPS
	1. Gather textContent from <options> within <select> items: check
	2. Append new text to begining of string: Check
	3. Save string to local storage: Check
	4. Add to <select> on page refresh: 
-->


<html>
	<head>
		
		<!-- jQuery Library-->
				<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
	</head>
<body>

<select id="myActivity"></select>
<br>
<br>
<input type="text" id="activityInput">  <button id="upload" onclick="addText()">update</button><br>

<script>
	
if (typeof(Storage) !== "undefined") {
    
    city = ['Jogging', 'Babysitting', 'Homework','Cooking', 'Cleaning'];
	var city_str = JSON.stringify(city);
	localStorage.setItem("locals", JSON.stringify(city_str));
	///////////////
    var storedNames = JSON.parse(localStorage.getItem("locals"));
    storedNames=storedNames.slice(1, -1);
    storedNames=storedNames.replace(/"/g, "");
    g = storedNames.split(",");
	    
	    i=0
	var text = "";
	while (i < g.length) {
	     text += '<option value="'+g[i]+'">'+g[i]+'</option>';       
	    i++;
	}
document.getElementById("myActivity").innerHTML = text;   

} else {
    document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
}
/*

function updateList(){

 	var b = document.getElementById("activityInput").value;
	var newSubject ='<option value="'+b+'">'+b+'</option>';
	
	city_str2=newSubject+text; 													
	document.getElementById("myActivity").innerHTML = newSubject+text;
	localStorage.setItem("locals", city_str2);
};
*/
////////////////////////
var x = document.getElementById("myActivity"); // this is somehow grabbing each option
var txt = "";
var i;
for (i = 0; i < x.length; i++) {
    txt = txt + x.options[i].text+' ';
} 
//tArray=txt.split("");
/*
	document.getElementById("result").innerHTML = txt;   
	thy=document.getElementById('result').textContent;
	thy = thy.split(" ")
	alert(thy[0]);
*/
function addText(){
	textVal=document.getElementById('activityInput').value;	
	textVal=textVal+" "+txt;

	localStorage.setItem("myStorage", textVal);
	///////
	 var storedText = localStorage.getItem("myStorage");
	 k=storedText.split(" ");

	    u=0
	var text = "";
	while (u < k.length-1) {
	     text += '<option value="'+k[u]+'">'+k[u]+'</option>';       
	    u++;
	}
	alert(text)
document.getElementById("myActivity").innerHTML = text;
    txt=text; //// This line partially works as expected.
}



  
</script>

</body>
</html>